Parfait Kevin, tu veux que ton **agent IA soit un vrai analyste financier augmentÃ© Ã  la Top Gun** ğŸ’¥. AprÃ¨s analyse complÃ¨te de :

- ton **code `agent.py`**,  
- ta **requÃªte API S&D** (Scores & DÃ©cisions),  
- et le **rÃ©sultat peu convaincant que tu obtiens dans Replit**,  

voici ce quâ€™il faut dire trÃ¨s concrÃ¨tement Ã  **lâ€™agent Replit** pour que Ã§a brille **et que Ã§a serve vraiment**. On va injecter les bonnes donnÃ©es + structurer la rÃ©ponse Maverick faÃ§on expert financier.

---

### âœ… ğ—”. Ce que tu dois dire Ã  lâ€™agent Replit (simple et clair)

> **1. Ajouter une requÃªte HTTP Ã  lâ€™API Scores & DÃ©cisions**
>
> â†’ CrÃ©e un fichier `scores.py` sâ€™il nâ€™existe pas.  
> â†’ Dans ce fichier, ajoute cette fonction pour rÃ©cupÃ©rer les donnÃ©es financiÃ¨res :
>
```python
import requests

def get_score_data(siren):
    url = f"https://ws.scores-decisions.com/api/V1/service/entreprise/act/getIndiScore/?siren={siren}"
    headers = {
        "Authorization": "Basic a21hbWVyaXdzOmk1T0tkUXZu"  # <- Ton token ici
    }
    res = requests.get(url, headers=headers)
    if res.status_code == 200:
        return res.json().get("body", {})
    else:
        print(f"Erreur API Scores & DÃ©cisions : {res.status_code}")
        return {}
```

---

> **2. Dans `main.py` (ou Ã©quivalent), fusionne `company_data` avec le retour Scores & DÃ©cisions :**

```python
from societeinfo import get_company_data
from scores import get_score_data
from agent import analyze_company

siren = "521286443"  # SIREN cible
company_data = get_company_data(siren)
score_data = get_score_data(siren)

# Fusion des donnÃ©es
company_data.update(score_data)

result = analyze_company(company_data)
print(result)
```

---

> **3. Adapter le prompt dans `agent.py` pour que Maverick analyse comme un expert, avec structure Markdown :**

```python
prompt = f"""
Tu es un expert analyste financier IA. Analyse lâ€™entreprise suivante Ã  partir des donnÃ©es fournies. Rends une recommandation dÃ©taillÃ©e sous forme structurÃ©e en 4 blocs, avec des emojis, du markdown, et un langage clair, synthÃ©tique et pro.

---

ğŸ“Š **1. Score de Risque**

- Score : {company_data.get('classeRisque', 'ND')} / 10
- Indiscore : {company_data.get('Indiscore20', 'ND')} (secteur : {company_data.get('Indiscore20_secteur', 'ND')})
- Code couleur : {"ğŸŸ¢" if company_data.get('classeRisque', 0) <= 3 else "ğŸŸ¡" if company_data.get('classeRisque', 0) <= 5 else "ğŸ”´"}

---

ğŸ’¼ **2. Analyse financiÃ¨re avancÃ©e**

- Chiffre d'affaires : {company_data.get('CA', 'ND')} â‚¬
- RÃ©sultat net : {company_data.get('resultat', 'ND')} â‚¬
- EBE : {company_data.get('EBE', 'ND')} â‚¬
- Fonds propres : {company_data.get('FondsPr', 'ND')} â‚¬
- FR / BFR : {company_data.get('FR', 'ND')} / {company_data.get('BFR', 'ND')}
- DÃ©lai clients : {company_data.get('DelaiCli', 'ND')} jours / DÃ©lai fournisseurs : {company_data.get('DelaiFour', 'ND')} jours

---

ğŸ•’ **3. Recommandation Paiement**

- Encours actuel : {company_data.get('encours', 'ND')} â‚¬
- Historique paiement : {company_data.get('infoPaiement', 'ND')}
- Recommandation IA : 30 jours si bonne expÃ©rience, sinon paiement comptant
- Justification : BasÃ©e sur solvabilitÃ©, trÃ©sorerie, dÃ©lais et encours

---

ğŸ‘¨â€ğŸ’¼ **4. Analyse dirigeance / conformitÃ©**

- Dirigeant : {company_data.get('dirigeant', 'ND')}
- Analyse : {company_data.get('AnalyseDirigeance', 'ND')}
- ConformitÃ© : {company_data.get('AnalyseConfor', 'ND')} (score : {company_data.get('ScoreConfor', 'ND')})

---

ğŸ“¡ **(Optionnel) Veille marchÃ©**
Ajoute une actu rÃ©cente pertinente si possible via API `get-events` de Societeinfo ou Bing Search (optionnel).
"""
```

---

### âœ… ğ—•. Pourquoi ton prompt actuel ne donne rien de "wow"

- Il est **trop court et peu structurÃ©**.
- Tu n'exploites pas les **donnÃ©es financiÃ¨res riches de Scores & DÃ©cisions**.
- Maverick est puissantâ€¦ mais il lui faut un **contexte riche, guidÃ©, et bien formatÃ©**.

---

### âœ… ğ—–. Et pour briller en Top Gun ?

ğŸ‘‰ Termine par cette phrase dans ton prompt :

> _â€œAgis comme un analyste qui rÃ©dige un rapport pour un comitÃ© de crÃ©dit. Tu dois Ãªtre clair, structurÃ©, expert et orientÃ© dÃ©cision. Nâ€™invente pas. Base-toi uniquement sur les donnÃ©es fournies.â€_

---

Souhaites-tu que je te gÃ©nÃ¨re directement tous les fichiers corrigÃ©s (`agent.py`, `scores.py`, etc.) Ã  copier-coller dans Replit ?