Voici exactement ce que tu dois indiquer Ã  lâ€™agent Replit, Ã©tape par Ã©tape, pour intÃ©grer lâ€™API Scores & DÃ©cisions, enrichir company_data, et adapter le prompt pour Maverick avec une rÃ©ponse ultra structurÃ©e ğŸ‘‡

âœ… Ã‰tape 1 : Ajouter une requÃªte HTTP Ã  lâ€™API Scores & DÃ©cisions
ğŸ‘‰ Dans un fichier scores_decisions.py ou directement dans ton script principal, ajouter ceci :

python
Copier
Modifier
import requests
import base64

SD_TOKEN = "a21hbWVyaXdzOmk1T0tkUXZu"  # ton token API encodÃ© en base64

def get_scores_decisions_data(siren):
    url = f"https://ws.scores-decisions.com/api/V1/service/entreprise/act/getIndiScore/{siren}"
    headers = {
        "Authorization": f"Basic {SD_TOKEN}",
        "Accept": "application/json"
    }
    res = requests.get(url, headers=headers)
    if res.status_code != 200:
        print("Erreur S&D :", res.status_code)
        return {}
    
    data = res.json()
    # Extraction des champs utiles
    result = {
        "indiscore20": data.get("Indiscore20"),
        "indiscore20_secteur": data.get("Indiscore20_secteur"),
        "AnalyseDirigeance": data.get("AnalyseDirigeance"),
        "ScoreConfor": data.get("ScoreConfor"),
        "AnalyseConfor": data.get("AnalyseConfor"),
        "encours": data.get("encours"),
        "classeRisque": data.get("classeRisque"),
        "FondsPr": data.get("Bilans", [{}])[0].get("FondsPr"),
        "EBE": data.get("Bilans", [{}])[0].get("EBE"),
        "DelaiCli": data.get("Bilans", [{}])[0].get("DelaiCli"),
        "DelaiFour": data.get("Bilans", [{}])[0].get("DelaiFour"),
        "Afdcc1": data.get("Afdcc1"),
        "ConanH": data.get("ConanH")
    }
    return result
âœ… Ã‰tape 2 : Ajouter ces donnÃ©es au company_data
Dans ton orchestrateur principal (main.py, app.py ou autre) :

python
Copier
Modifier
from scores_decisions import get_scores_decisions_data

# aprÃ¨s avoir rÃ©cupÃ©rÃ© les donnÃ©es de societeinfo
scores_data = get_scores_decisions_data(siren)
if scores_data:
    company_data.update(scores_data)
âœ… Ã‰tape 3 : Adapter le prompt pour que Maverick structure sa rÃ©ponse
Tu modifies ton prompt comme suit dans agent.py :

python
Copier
Modifier
prompt = f"""
Tu es un analyste crÃ©dit IA expert. Tu dois Ã©mettre une synthÃ¨se d'analyse crÃ©dit claire, lisible et structurÃ©e pour un dÃ©cideur financier.

Voici les donnÃ©es de lâ€™entreprise Ã  analyser :

ğŸ“Œ Profil entreprise
- Nom : {company_data['nom']}
- SIREN : {company_data['siren']}
- Forme : {company_data['forme_juridique']}
- CA : {company_data['ca']} â‚¬
- RÃ©sultat : {company_data['resultat']} â‚¬
- Capitaux propres : {company_data['capitaux']} â‚¬
- EBE : {company_data.get('EBE')}
- Fonds propres : {company_data.get('FondsPr')}
- Classe de risque : {company_data.get('classeRisque')}
- Score S&D : {company_data.get('indiscore20')} (secteur : {company_data.get('indiscore20_secteur')})

ğŸ“Š Contexte commercial
- RÃ´le : {company_data['relation']}
- Historique paiement : {company_data['historique']}
- Encours envisagÃ© : {company_data['encours']} â‚¬
- DÃ©lai souhaitÃ© : {company_data['delai_souhaite']}

ğŸ§  Autres indicateurs
- Afdcc1 : {company_data.get('Afdcc1')}
- ConanH : {company_data.get('ConanH')}
- DÃ©lai client moyen : {company_data.get('DelaiCli')}
- DÃ©lai fournisseur moyen : {company_data.get('DelaiFour')}

ğŸ” Dirigeance & conformitÃ©
- Analyse dirigeance : {company_data.get('AnalyseDirigeance')}
- ConformitÃ© : {company_data.get('AnalyseConfor')}
- Score conformitÃ© : {company_data.get('ScoreConfor')}
- Info paiements : {company_data.get('infoPaiement', 'ND')}

ğŸ“¬ DerniÃ¨res actualitÃ©s (veille marchÃ©) :
{company_data.get('evenements_formates', '- Aucune info rÃ©cente disponible')}

---

âœï¸ Ta mission :
Structure ta rÃ©ponse en **4 blocs Markdown** :
1. ğŸ¯ Score de risque : Ã©value le score sur 10 et indique un code couleur (vert = faible risque, orange = moyen, rouge = Ã©levÃ©)
2. ğŸ“Š Analyse financiÃ¨re : rÃ©sume la performance financiÃ¨re avec CA, rÃ©sultat, EBE, BFR, capitaux, ratios, etc.
3. â±ï¸ Recommandation de paiement : indique si le paiement doit Ãªtre comptant / 30j / 60j avec une justification claire.
4. ğŸ” Analyse de la gouvernance & conformitÃ© : synthÃ©tise la dirigeance, conformitÃ© et encours.

En bonus : termine par une **phrase â€œveille marchÃ©â€** si des Ã©vÃ©nements rÃ©cents sont dÃ©tectÃ©s.

Formate ta rÃ©ponse de maniÃ¨re **pro** et **impactante** pour un DAF.
"""
ğŸ’¬ Ce que tu dis Ã  lâ€™agent Replit :
Ajoute une fonction pour appeler lâ€™API Scores & DÃ©cisions (voir le code). Mets Ã  jour company_data avec les donnÃ©es retournÃ©es. Adapte le prompt envoyÃ© Ã  Maverick pour quâ€™il suive une structure Ã  4 blocs bien dÃ©finis :

Score de risque (avec code couleur)

Analyse financiÃ¨re

Recommandation dÃ©lai de paiement

Analyse dirigeance / conformitÃ©

Termine par une ligne "veille marchÃ©" si on a des Ã©vÃ©nements rÃ©cents. Lâ€™objectif est dâ€™avoir une rÃ©ponse claire, structurÃ©e, professionnelle et exploitable en B2B.